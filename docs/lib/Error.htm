<!DOCTYPE HTML>
<html lang="en">
<head>
<title>Error Object | AutoHotkey v2</title>
<meta name="description" content="Error objects thrown by built-in code when an error occurs." />
<meta name="ahk:equiv-v1" content="index.htm" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<link href="../static/dark.css" rel="stylesheet" type="text/css" media="(prefers-color-scheme: dark)" id="dark_css" />
<script src="../static/content.js" type="text/javascript"></script>
</head>
<body>

<h1>Error Object</h1>
<pre class="NoIndent">class Error extends Object</pre>

<p>Error objects are <a href="Throw.htm">thrown</a> by built-in code when a runtime error occurs, and may also be thrown explicitly by the script.</p>
<p>Error objects can be created with <a href="#Call">Error()</a> and retrieved with <a href="Catch.htm">Catch</a>.</p>
<p>"ErrorObj" is used below as a placeholder for any Error object, as "Error" is the class itself.</p>
<p>In addition to the methods and properties inherited from <a href="Object.htm">Object</a>, Error objects have the following predefined methods and properties.</p>

<h2 id="toc">Table of Contents</h2>
<ul class="indent">
  <li><a href="#Static_Methods">Static Methods</a>:
    <ul>
      <li><a href="#Call">Call</a>: Creates an Error object.</li>
    </ul>
  </li>
  <li><a href="#Properties">Properties</a>:
    <ul>
      <li><a href="#Extra">Extra</a>: Retrieves or sets a string relating to the error.</li>
      <li><a href="#File">File</a>: Retrieves or sets the path of the script file containing the line at which the error occurred.</li>
      <li><a href="#Line">Line</a>: Retrieves or sets the line number at which the error occurred.</li>
      <li><a href="#Message">Message</a>: Retrieves or sets the error message.</li>
      <li><a href="#Stack">Stack</a>: Retrieves or sets the call stack when the Error object was constructed.</li>
      <li><a href="#What">What</a>: Retrieves or sets the source that threw the exception.</li>
    </ul>
  </li>
  <li>General:
    <ul>
      <li><a href="#error-types">Error Types</a></li>
      <li><a href="#Remarks">Remarks</a></li>
      <li><a href="#Related">Related</a></li>
    </ul>
  </li>
</ul>

<h2 id="Static_Methods">Static Methods</h2>

<div class="methodShort" id="Call"><span id="new"></span><h3>Call</h3>
<p>Creates an Error object.</p>
<pre class="Syntax">ErrorObj := <i>Error</i>(Message <span class="optional">, What, Extra</span>)
ErrorObj := <i>Error</i>.<span class="func">Call</span>(Message <span class="optional">, What, Extra</span>)</pre>
<p><em>Error</em> may be replaced with one of the subclasses listed under <a href="#error-types">Error Types</a>, although some subclasses may take different parameters.</p>
<p>The parameters directly correspond to the <a href="#Message">Message</a>, <a href="#What">What</a>, and <a href="#Extra">Extra</a> properties, but may differ for Error subclasses which override the __New method.</p>
<p><em>Message</em> and <em>Extra</em> are converted to strings. These are displayed by an error dialog if the exception is thrown and not caught.</p>
<p><em>What</em> indicates the source of the error. It can be an arbitrary string, but should be a negative integer or the name of a running function. Specifying -1 indicates the current function, -2 indicates the function which called it, and so on. If the script is <a href="../Scripts.htm#ahk2exe">compiled</a> or the value does not identify a valid stack frame, the value is merely converted to a string and assigned to <code>NewError.What</code>. Otherwise, the identified stack frame is used as follows to determine the other properties:</p>
<ul>
  <li><code>NewError.What</code> contains the name of the function.</li>
  <li><code>NewError.Line</code> and <code>NewError.File</code> indicate the line which <em>called</em> the function.</li>
  <li><code>NewError.Stack</code> contains a partial stack trace, with the indicated stack frame at the top.</li>
</ul>
<p>Use of the <em>What</em> parameter can allow a complex function to use helper functions to perform its work or parameter validation, while omitting those internal details from any reported error information. For example:</p>
<pre>MyFunction(a, b) {
    CheckArg "a", a
    CheckArg "b", b
    <em>;...</em>
    CheckArg(name, value) {
        if value &lt; 0
            throw ValueError(name " is negative", "myfunction", value)
    }
}

try
    MyFunction(1, -1)  <em>; err.Line indicates this line.</em>
catch ValueError as err
    MsgBox Format("{1}: {2}.`n`nFile:`t{3}`nLine:`t{4}`nWhat:`t{5}`nStack:`n{6}"
        , type(err), err.Message, err.File, err.Line, err.What, err.Stack)</pre>
<pre>try
    SomeFunction()
catch as e
    MsgBox(type(e) " in " e.What ", which was called at line " e.Line)

SomeFunction() {
    throw Error("Fail", -1)
}</pre>
</div>

<span id="Standard_Properties"></span><h2 id="Properties">Properties</h2>

<div class="methodShort" id="Extra"><h3>Extra</h3>
<p>Retrieves or sets a string relating to the error.</p>
<pre class="Syntax">CurrentExtra := ErrorObj.<span class="func">Extra</span></pre>
<pre class="Syntax">ErrorObj.<span class="func">Extra</span> := NewExtra</pre>
<p>The standard error dialog displays a line with "Specifically:" followed by this string.</p>
</div>

<div class="methodShort" id="File"><h3>File</h3>
<p>Retrieves or sets the full path of the script file containing the line at which the error occurred, or at which the Error object was constructed.</p>
<pre class="Syntax">CurrentFile := ErrorObj.<span class="func">File</span></pre>
<pre class="Syntax">ErrorObj.<span class="func">File</span> := NewFile</pre>
</div>

<div class="methodShort" id="Line"><h3>Line</h3>
<p>Retrieves or sets the line number at which the error occurred, or at which the Error object was constructed.</p>
<pre class="Syntax">CurrentLine := ErrorObj.<span class="func">Line</span></pre>
<pre class="Syntax">ErrorObj.<span class="func">Line</span> := NewLine</pre>
</div>

<div class="methodShort" id="Message"><h3>Message</h3>
<p>Retrieves or sets the error message.</p>
<pre class="Syntax">CurrentMessage := ErrorObj.<span class="func">Message</span></pre>
<pre class="Syntax">ErrorObj.<span class="func">Message</span> := NewMessage</pre>
</div>

<div class="methodShort" id="Stack"><h3>Stack</h3>
<p>Retrieves or sets a string representing the call stack at the time the Error object was constructed.</p>
<pre class="Syntax">CurrentStack := ErrorObj.<span class="func">Stack</span></pre>
<pre class="Syntax">ErrorObj.<span class="func">Stack</span> := NewStack</pre>
<p>Each line may be formatted as follows:</p>
<dl>
  <dt><code class="no-highlight"><i>File</i> (<i>Line</i>) : [<i>What</i>] <i>SourceCode</i>`r`n</code></dt>
  <dd>Represents a call to the function <em>What</em>. <em>File</em> and <em>Line</em> indicate the current script line at this stack depth. <em>SourceCode</em> is an approximation of the source code at that line, as it would be shown in <a href="ListLines.htm">ListLines</a>.</dd>
  <dt><code class="no-highlight">&gt; <i>What</i>`r`n</code></dt>
  <dd>Represents the launching of a thread, typically the direct cause of the function call above it.</dd>
  <dt><code class="no-highlight">... <i>N</i> more</code></dt>
  <dd>Indicates that the stack trace was truncated, and there are <em>N</em> more stack entries not shown. Currently the <code class="no-highlight">Stack</code> property cannot exceed 2047 characters.</dd>
</dl>
</div>

<div class="methodShort" id="What"><h3>What</h3>
<p>Retrieves or sets the source that threw the exception.</p>
<pre class="Syntax">CurrentWhat := ErrorObj.<span class="func">What</span></pre>
<pre class="Syntax">ErrorObj.<span class="func">What</span> := NewWhat</pre>
<p>This is usually the name of a function, but is blank for exceptions thrown due to an error in an expression (such as using a math operator on a non-numeric value).</p>
</div>

<h2 id="error-types">Error Types</h2>

<p>The following subclasses of <strong>Error</strong> are predefined:</p>
<ul>
  <li id="MemoryError"><strong>MemoryError:</strong> A memory allocation failed.</li>
  <li id="OSError"><strong>OSError:</strong> An internal function call to a Win32 function failed. <strong>Message</strong> includes an error code and description generated by the operating system. OSErrors have an additional <strong>Number</strong> property which contains the error code. Calling <code>OSError(Code)</code> where <em>Code</em> is numeric sets <em>Number</em> and <em>Message</em> based on the given OS-defined error code. If <em>Code</em> is omitted, it defaults to <a href="../Variables.htm#LastError">A_LastError</a>. For example, <code>OSError(5).Message</code> returns "(5) Access is denied."</li>
  <li id="TargetError"><strong>TargetError:</strong> A function failed because its target could not be found. <strong>Message</strong> indicates what kind of target, such as a window, control, menu or status bar.</li>
  <li id="TimeoutError"><strong>TimeoutError:</strong> <a href="SendMessage.htm">SendMessage</a> timed out.</li>
  <li id="TypeError"><strong>TypeError:</strong> An unexpected type of value was used as input for a function, property assignment, or some other operation. Usually <strong>Message</strong> indicates the expected and actual type, and <strong>Extra</strong> contains a string representing the errant value.</li>
  <li id="UnsetError"><strong>UnsetError:</strong> An attempt was made to read the value of a variable, property or item, but there was no value.<ul>
    <li id="MemberError"><strong>MemberError</strong><ul>
      <li id="PropertyError"><strong>PropertyError</strong></li>
      <li id="MethodError"><strong>MethodError</strong></li>
    </ul></li>
    <li id="UnsetItemError"><strong>UnsetItemError</strong></li>
  </ul></li>
  <li id="ValueError"><strong>ValueError:</strong> An unexpected value was used as input for a function, property assignment, or some other operation. Usually <strong>Message</strong> indicates which expectation was broken, and <strong>Extra</strong> contains a string representing the errant value.<ul>
    <li id="IndexError"><strong>IndexError:</strong> The index parameter of an object's <a href="../Objects.htm#__Item">__Item property</a> was invalid or out of range.</li>
  </ul></li>
  <li id="ZeroDivisionError"><strong>ZeroDivisionError:</strong> Division by zero was attempted in an expression or with the Mod function.</li>
</ul>
<p>Errors are also thrown using the base Error class.</p>

<h2 id="Remarks">Remarks</h2>
<p>The standard error dialog requires the Message, Extra, File and Line properties to be <a href="Object.htm">own value properties</a>.</p>

<h2 id="Related">Related</h2>
<p><a href="Throw.htm">Throw</a>, <a href="Try.htm">Try</a>, <a href="Catch.htm">Catch</a>, <a href="Finally.htm">Finally</a>, <a href="OnError.htm">OnError</a></p>

</body>
</html>